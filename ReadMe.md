# Lineal üìè: An Efficient Header-Only C++20 Linear Algebra Library

**Lineal** (a portmanteau of ‚ÄúLinear Algebra‚Äù, but also German ‚Äúruler‚Äù) is a C++20 linear algebra library designed to solve large sparse linear systems arising from PDE discretization on attainable hardware by optimizing runtime and, especially, memory consumption.
To this end, Lineal supports matrix-free linear systems for stencil-based problems, which can store a single value per cell (which can be as little as one byte) to minimize memory use.
Because of Lineal‚Äôs very generic, template-heavy approach in which matrices and vectors are just characterized by a set of members they need to provide (i.e. _named requirements_ in the jargon of the C++ standard), the ‚Äúmatrix-free‚Äù matrix and vector classes can be used mostly interchangeably with more traditional CSR matrices or dense vectors.

Consequently, Lineal allows matrix-free linear systems to be paired with **MAMGO** ü•≠, Lineal‚Äôs Algebraic Multi-Grid (AMG) preconditioner based on the algorithm used in [DUNE ISTL](https://gitlab.dune-project.org/core/dune-istl/-/tree/master/dune/istl/paamg), using a matrix-free linear system on the finest level while using CSR matrices and coarse vectors on coarser levels, which is required due to the unstructured nature of the AMG method.
This drastically reduces memory consumption on the finest level, which (by nature of the AMG method) is the largest level by far, and is a novel approach, to the best of my knowledge.
MAMGO works best, as is mainly used, as a preconditioner to a Krylov subspace method, such as the CG method.

Due to Lineal‚Äôs heavy use of very generic templates, the aforementioned components (and most others) can be combined with Lineal‚Äôs flexible support for mixed precision to minimize memory use as well as the effect of reduced precision on convergence.
Additionally, almost all components are fully multithreaded (with support for thread pinning) and many support explicit SIMD operations and/or tiling.

Further details about the design of Lineal, as well as an evaluation of various features and comparisons with [hypre‚Äôs BoomerAMG](https://hypre.readthedocs.io/en/latest/solvers-boomeramg.html), [DUNE ISTL](https://gitlab.dune-project.org/core/dune-istl/-/tree/master/dune/istl/paamg), and [Ginkgo](https://ginkgo-project.github.io/), are presented in _Lineal: An Efficient Linear Algebra Library_, a paper by Kurt B√∂hm (the author of this library) and Olaf Ippisch (the research supervisor).
While the paper is currently under review, a preprint of this paper is already available [on Research Square](https://www.researchsquare.com/article/rs-6329564/latest).
The results shown there demonstrate Lineal‚Äôs much lower memory consumption compared to the aforementioned libraries, which makes it the only library tested to be able to handle the largest dataset used for the evaluation, as well as its very low runtimes, outperforming the other libraries in all but one case (in which its performance is still very comparable), often by large margins.

_Please note that this repository in its current form is a temporary solution to provide access to the shared-memory components of Lineal.
As it has been generated by removing distributed-memory components, it contains a few utilities for supporting distributed-memory parallelism that do not serve a purpose in the present form, but do in the full version of Lineal.
The full repository, including support for distributed-memory and hybrid parallelism, will replace this repository in due time._

## Building

Lineal uses the Meson build system and includes a fairly extensive (yet incomplete) set of tests.
These can be run by executing `meson setup -C <build directory>` followed by `meson test -C <build directory>`.
`Makefile` contains targets for calling `meson setup` with different optimization and debug settings.

## Dependencies

Dependencies are handled using Meson subprojects, which make it possible to use Lineal without installing any packages.
The Meson subprojects are managed by [Tlaxcaltin](https://github.com/KurtBoehm/tlaxcaltin) and are:

- [Thesauros](https://github.com/KurtBoehm/thesauros): Many basic components, from data structures to threading utilities to static ranges and many other things.
- [Stado](https://github.com/KurtBoehm/stado): The SIMD backend to **Grex**. I am currently working on a standalone Grex library to replace this arrangement.
- [`ankerl::unordered_dense::{map, set}`](https://github.com/martinus/unordered_dense): A fast dense hash map/set.

The tests require the following additional dependencies:

- [`options`](https://github.com/KurtBoehm/tlaxcaltin/blob/main/options/meson.build): Compiler options to enable more warnings and optimization settings.
- [`argparse`](https://github.com/p-ranav/argparse): Command-line argument parsing for modern C++.
- [`pcg-cpp`](https://github.com/imneme/pcg-cpp.git): Efficient and high-quality pseudo-random number generation.

## Limitations

Currently, Lineal is limited to Linux on x86-64.
I am currently working on extending platform support to ARM using NEON for vectorization, as well as supporting non-vectorized execution on any other platform.
Following this transition, I am planning on generalizing Linux-specific functionality to other operating systems (or disabling it on unsupported operating systems).

## Licences

Lineal is licensed under the terms of the Mozilla Public Licence 2.0, which is provided in [`License`](License).
